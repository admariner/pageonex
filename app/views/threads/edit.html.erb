<%= javascript_include_tag "jquery.miniColors.js" %>
<%= stylesheet_link_tag "jquery.miniColors.css" %>

<%= form_for @thread, :url=> { :controller => :threads, :action => :update}, method: "PUT" do |f| %>
  <div id="errors">
    <% if @thread.errors.any? %>
      <div class="alert alert-error">
        <% @thread.errors.full_messages.each do |msg| %>
            <li><%= msg %></li>
        <% end %>
            <li id="date_message" style="display:none">End date must be greater than start date</li>
            <li id="media_message" style="display:none">You must at least select one newspaper</li>
            <li id="topic_name_message" style="display:none">Topic name cannot be empty</li>
            <li id="topic_color_message" style="display:none">Topic color cannot be empty</li>
      </div>
    <% end %>
  </div>
  <%= f.label :thread_display_name, "Thread Name" %>
  <%= f.text_field :thread_display_name %><br />

  <%= f.label :start_date %>
	<%= f.text_field :start_date %>

	<%= f.label :end_date %>
	<%= f.text_field :end_date %>

  <%= f.label :status %>
  <%= f.text_field :status %><br>

  <%= f.label :category %>
  <%= f.text_field :category %><br>

  <%= f.label :description %>
	<%= f.text_area :description, :rows => "10"%><br>

  <h2>Newspapers info</h2><br>
  <div id="media_box">
    <%= label_tag :media, nil, :id => "media_label1" %>
    <%= select_tag :media, options_from_collection_for_select(@media, "id", "name"),  :multiple => true , style: "height: 300px;width: 300px;", :class=>"js_validate" %>
    <br>

    <%= hidden_field_tag :org_media, params["media"] %>
  </div>


  <hr>
  <h2>Coding info</h2><br>

  <div class="well">
    <div id="topic_1" class="well">
      <div id="topic_name_box">
        <%= label_tag "topic_name_1", nil, :id => "topic_label_1" %>

        <%= text_field_tag "topic_name_1",@thread.codes[0].code_text,placeholder: "Code/Topic name", :class=>"topic_name js_validate" %> 
        
      </div>

      <div class="topic_color_box ">
        <%= label_tag "topic_color_1", nil, :id => "topic_color_label_1" %>

        <%= text_field_tag "topic_color_1",@thread.codes[0].color,placeholder: "#FF0000", :class=>"topic_color js_validate" %> 
        
      </div>

      <%= label_tag "topic_description_1", nil, :id => "topic_description_label_1" %>

      <%= text_area_tag "topic_description_1",@thread.codes[0].code_description,:rows => "5",placeholder: "Some Info about that topic" %> 
    </div>
  </div>

  <hr>
  <%= f.submit "Update Thread", :class => "btn" %>
  <!-- <a class="btn btn-primary" href='<%="/users/#{current_user.username}/threads/#{@thread.thread_name}"%>' >Cancel</a> -->
  <a class="btn btn-primary" href='<%="/threads/"%>' >Cancel</a>
<% end %>

<script type="text/javascript">
$(function () {
  $("#media").val($("#org_media").attr("value").split(" "));

  $(".topic_color").miniColors({
    change: function (hex,rgb) {
      $(".miniColors-trigger").css("background-color",hex)
      }
    });

  $(".miniColors-trigger").attr("style","margin-bottom:9px;width: 214px;height: 26px;display: block;").css("background-color", $(".miniColors").attr("value"))
  

})
</script>